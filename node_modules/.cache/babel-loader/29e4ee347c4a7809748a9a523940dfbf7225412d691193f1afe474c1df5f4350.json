{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lucas\\\\OneDrive\\\\Documentos\\\\Minimarket PRO\\\\Version 1.0\\\\src\\\\components\\\\ReportsDashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport DailySalesChart from './DailySalesChart';\nimport TopProductsChart from './TopProductsChart';\nimport ProfitSummary from './ProfitSummary';\nimport { generateSalesReport, generateCashRegisterReport, generateCurrentAccountReport } from '../utils/pdfGenerator';\nimport { isAdmin, getCurrentMarket, isMarket } from '../utils/auth';\nimport { getAllData } from '../utils/indexedDb';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ReportsDashboard = ({\n  selectedMarket\n}) => {\n  _s();\n  const [sales, setSales] = useState([]);\n  const [products, setProducts] = useState([]);\n  const [customers, setCustomers] = useState([]);\n  const [cashMovements, setCashMovements] = useState([]);\n  const [timeRange, setTimeRange] = useState('day');\n  const [paymentSummary, setPaymentSummary] = useState({\n    cash: 0,\n    debit: 0,\n    credit: 0,\n    transfer: 0,\n    mp: 0,\n    current_account: 0,\n    paid_current_account: 0\n  });\n  useEffect(() => {\n    const loadData = async () => {\n      const allSales = await getAllData('sales');\n      const allProducts = await getAllData('products');\n      const allCustomers = await getAllData('customers');\n      const allCashMovements = await getAllData(`cashMovements_${getCurrentMarket()}`);\n      const marketToShow = isAdmin() ? selectedMarket : getCurrentMarket();\n      const filteredSales = isAdmin() && selectedMarket ? allSales.filter(s => s.marketId === selectedMarket) : allSales.filter(s => s.marketId === marketToShow);\n      const filteredProducts = isAdmin() && selectedMarket ? allProducts.filter(p => p.marketId === selectedMarket) : allProducts.filter(p => p.marketId === marketToShow);\n      const filteredCustomers = isAdmin() && selectedMarket ? allCustomers.filter(c => c.marketId === selectedMarket) : allCustomers.filter(c => c.marketId === marketToShow);\n      const filteredCashMovements = allCashMovements.filter(m => m.marketId === marketToShow);\n\n      // Filtrar ventas por rango de tiempo\n      const now = new Date();\n      const salesInTimeRange = filteredSales.filter(sale => {\n        const saleDate = new Date(sale.date);\n        if (timeRange === 'day') {\n          return saleDate.toDateString() === now.toDateString();\n        } else if (timeRange === 'week') {\n          const weekAgo = new Date(now);\n          weekAgo.setDate(weekAgo.getDate() - 7);\n          return saleDate >= weekAgo;\n        } else if (timeRange === 'month') {\n          const monthAgo = new Date(now);\n          monthAgo.setMonth(monthAgo.getMonth() - 1);\n          return saleDate >= monthAgo;\n        } else if (timeRange === 'year') {\n          const yearAgo = new Date(now);\n          yearAgo.setFullYear(yearAgo.getFullYear() - 1);\n          return saleDate >= yearAgo;\n        }\n        return true; // 'all'\n      });\n\n      // Calcular resumen de pagos\n      const summary = {\n        cash: 0,\n        debit: 0,\n        credit: 0,\n        transfer: 0,\n        mp: 0,\n        current_account: 0,\n        paid_current_account: 0\n      };\n      salesInTimeRange.forEach(sale => {\n        summary[sale.paymentMethod] += sale.total;\n      });\n      setPaymentSummary(summary);\n      setSales(salesInTimeRange);\n      setProducts(filteredProducts);\n      setCustomers(filteredCustomers);\n      setCashMovements(filteredCashMovements);\n    };\n    loadData();\n  }, [selectedMarket, timeRange]);\n  const getTopProducts = () => {\n    const productSales = {};\n    sales.forEach(sale => {\n      sale.items.forEach(item => {\n        if (!productSales[item.productId]) {\n          productSales[item.productId] = {\n            quantity: 0,\n            revenue: 0,\n            name: item.name\n          };\n        }\n        productSales[item.productId].quantity += item.quantity;\n        productSales[item.productId].revenue += item.subtotal;\n      });\n    });\n    return Object.entries(productSales).map(([id, data]) => ({\n      id,\n      ...data\n    })).sort((a, b) => b.quantity - a.quantity).slice(0, 5);\n  };\n  const getLoyalCustomers = () => {\n    const customerSales = {};\n    sales.forEach(sale => {\n      if (sale.customerName && sale.customerName !== 'Consumidor Final') {\n        if (!customerSales[sale.customerName]) {\n          customerSales[sale.customerName] = {\n            totalSpent: 0,\n            visitCount: 0,\n            name: sale.customerName,\n            dni: sale.customerDNI\n          };\n        }\n        customerSales[sale.customerName].totalSpent += sale.total;\n        customerSales[sale.customerName].visitCount += 1;\n      }\n    });\n    return Object.values(customerSales).sort((a, b) => b.totalSpent - a.totalSpent).slice(0, 5);\n  };\n  const handleExportPDF = reportType => {\n    if (reportType === 'sales') {\n      generateSalesReport(sales, getTopProducts(), timeRange);\n    } else if (reportType === 'cashRegister') {\n      generateCashRegisterReport(cashMovements, timeRange);\n    } else if (reportType === 'currentAccounts') {\n      const currentAccountCustomers = {};\n      sales.forEach(sale => {\n        if (sale.paymentMethod === 'current_account' && sale.customerName) {\n          if (!currentAccountCustomers[sale.customerName]) {\n            currentAccountCustomers[sale.customerName] = {\n              name: sale.customerName,\n              dni: sale.customerDNI,\n              address: sale.customerAddress,\n              email: sale.customerEmail,\n              phone: sale.customerPhone,\n              totalDebt: 0,\n              sales: []\n            };\n          }\n          currentAccountCustomers[sale.customerName].totalDebt += sale.total;\n          currentAccountCustomers[sale.customerName].sales.push(sale);\n        }\n      });\n      generateCurrentAccountReport(Object.values(currentAccountCustomers), timeRange);\n    }\n  };\n  const getTimeRangeLabel = () => {\n    switch (timeRange) {\n      case 'day':\n        return 'Diario';\n      case 'week':\n        return 'Semanal';\n      case 'month':\n        return 'Mensual';\n      case 'year':\n        return 'Anual';\n      case 'all':\n        return 'Histórico';\n      default:\n        return '';\n    }\n  };\n  if (!isAdmin() && !isMarket()) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-10 text-gray-800 dark:text-white\",\n      children: \"Acceso no autorizado\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white p-6 rounded-lg shadow-md dark:bg-gray-800\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-bold text-gray-800 dark:text-white mb-6\",\n      children: \"Reportes y Estad\\xEDsticas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between items-center mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium text-gray-800 dark:text-white\",\n        children: [\"Reporte \", getTimeRangeLabel(), \" - \", sales.length, \" ventas registradas\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"select\", {\n          value: timeRange,\n          onChange: e => setTimeRange(e.target.value),\n          className: \"px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\",\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"day\",\n            children: \"Hoy\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"week\",\n            children: \"\\xDAltima semana\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"month\",\n            children: \"\\xDAltimo mes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"year\",\n            children: \"\\xDAltimo a\\xF1o\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"all\",\n            children: \"Todos\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative group\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\",\n            children: \"Exportar PDF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 dark:bg-gray-700\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleExportPDF('sales'),\n              className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left dark:text-gray-300 dark:hover:bg-gray-600\",\n              children: \"Reporte de Ventas\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleExportPDF('cashRegister'),\n              className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left dark:text-gray-300 dark:hover:bg-gray-600\",\n              children: \"Cierre de Caja\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleExportPDF('currentAccounts'),\n              className: \"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left dark:text-gray-300 dark:hover:bg-gray-600\",\n              children: \"Cuentas Corrientes\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ProfitSummary, {\n      sales: sales,\n      products: products\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white p-6 rounded-lg shadow-md dark:bg-gray-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-800 dark:text-white mb-4\",\n          children: \"Resumen de Pagos\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-gray-700 dark:text-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Efectivo:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [\"$\", paymentSummary.cash.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-gray-700 dark:text-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Tarjeta de D\\xE9bito:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [\"$\", paymentSummary.debit.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-gray-700 dark:text-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Tarjeta de Cr\\xE9dito:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [\"$\", paymentSummary.credit.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-gray-700 dark:text-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Mercado Pago:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [\"$\", paymentSummary.mp.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-gray-700 dark:text-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Cuenta Corriente:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [\"$\", paymentSummary.current_account.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between text-gray-700 dark:text-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Cta. Cte. Pagada:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [\"$\", paymentSummary.paid_current_account.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-t border-gray-200 pt-2 flex justify-between font-bold dark:border-gray-600 dark:text-white\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Total:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"$\", (paymentSummary.cash + paymentSummary.debit + paymentSummary.credit + paymentSummary.mp + paymentSummary.current_account + paymentSummary.paid_current_account).toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DailySalesChart, {\n        sales: sales\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(TopProductsChart, {\n        topProducts: getTopProducts()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white p-6 rounded-lg shadow-md dark:bg-gray-800\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-800 dark:text-white mb-4\",\n          children: \"Clientes M\\xE1s Fieles\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this), getLoyalCustomers().length > 0 ? /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"space-y-2\",\n          children: getLoyalCustomers().map((customer, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"flex justify-between items-center text-sm text-gray-700 dark:text-gray-300\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [customer.name, \" (\", customer.visitCount, \" compras)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium\",\n              children: [\"$\", customer.totalSpent.toFixed(2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-500 dark:text-gray-300\",\n          children: \"No hay datos de clientes fieles para mostrar.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 179,\n    columnNumber: 5\n  }, this);\n};\n_s(ReportsDashboard, \"52L3G6pRxhYiOOwMOieR2p/E+HM=\");\n_c = ReportsDashboard;\nexport default ReportsDashboard;\nvar _c;\n$RefreshReg$(_c, \"ReportsDashboard\");","map":{"version":3,"names":["React","useState","useEffect","DailySalesChart","TopProductsChart","ProfitSummary","generateSalesReport","generateCashRegisterReport","generateCurrentAccountReport","isAdmin","getCurrentMarket","isMarket","getAllData","jsxDEV","_jsxDEV","ReportsDashboard","selectedMarket","_s","sales","setSales","products","setProducts","customers","setCustomers","cashMovements","setCashMovements","timeRange","setTimeRange","paymentSummary","setPaymentSummary","cash","debit","credit","transfer","mp","current_account","paid_current_account","loadData","allSales","allProducts","allCustomers","allCashMovements","marketToShow","filteredSales","filter","s","marketId","filteredProducts","p","filteredCustomers","c","filteredCashMovements","m","now","Date","salesInTimeRange","sale","saleDate","date","toDateString","weekAgo","setDate","getDate","monthAgo","setMonth","getMonth","yearAgo","setFullYear","getFullYear","summary","forEach","paymentMethod","total","getTopProducts","productSales","items","item","productId","quantity","revenue","name","subtotal","Object","entries","map","id","data","sort","a","b","slice","getLoyalCustomers","customerSales","customerName","totalSpent","visitCount","dni","customerDNI","values","handleExportPDF","reportType","currentAccountCustomers","address","customerAddress","email","customerEmail","phone","customerPhone","totalDebt","push","getTimeRangeLabel","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","value","onChange","e","target","onClick","toFixed","topProducts","customer","index","_c","$RefreshReg$"],"sources":["C:/Users/lucas/OneDrive/Documentos/Minimarket PRO/Version 1.0/src/components/ReportsDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport DailySalesChart from './DailySalesChart';\nimport TopProductsChart from './TopProductsChart';\nimport ProfitSummary from './ProfitSummary';\nimport { generateSalesReport, generateCashRegisterReport, generateCurrentAccountReport } from '../utils/pdfGenerator';\nimport { isAdmin, getCurrentMarket, isMarket } from '../utils/auth';\nimport { getAllData } from '../utils/indexedDb';\n\nconst ReportsDashboard = ({ selectedMarket }) => {\n  const [sales, setSales] = useState([]);\n  const [products, setProducts] = useState([]);\n  const [customers, setCustomers] = useState([]);\n  const [cashMovements, setCashMovements] = useState([]);\n  const [timeRange, setTimeRange] = useState('day');\n  const [paymentSummary, setPaymentSummary] = useState({\n    cash: 0,\n    debit: 0,\n    credit: 0,\n    transfer: 0,\n    mp: 0,\n    current_account: 0,\n    paid_current_account: 0\n  });\n\n  useEffect(() => {\n    const loadData = async () => {\n      const allSales = await getAllData('sales');\n      const allProducts = await getAllData('products');\n      const allCustomers = await getAllData('customers');\n      const allCashMovements = await getAllData(`cashMovements_${getCurrentMarket()}`);\n      \n      const marketToShow = isAdmin() ? selectedMarket : getCurrentMarket();\n      const filteredSales = isAdmin() && selectedMarket ? \n        allSales.filter(s => s.marketId === selectedMarket) : \n        allSales.filter(s => s.marketId === marketToShow);\n      \n      const filteredProducts = isAdmin() && selectedMarket ? \n        allProducts.filter(p => p.marketId === selectedMarket) : \n        allProducts.filter(p => p.marketId === marketToShow);\n\n      const filteredCustomers = isAdmin() && selectedMarket ?\n        allCustomers.filter(c => c.marketId === selectedMarket) :\n        allCustomers.filter(c => c.marketId === marketToShow);\n\n      const filteredCashMovements = allCashMovements.filter(m => m.marketId === marketToShow);\n\n      // Filtrar ventas por rango de tiempo\n      const now = new Date();\n      const salesInTimeRange = filteredSales.filter(sale => {\n        const saleDate = new Date(sale.date);\n        if (timeRange === 'day') {\n          return saleDate.toDateString() === now.toDateString();\n        } else if (timeRange === 'week') {\n          const weekAgo = new Date(now);\n          weekAgo.setDate(weekAgo.getDate() - 7);\n          return saleDate >= weekAgo;\n        } else if (timeRange === 'month') {\n          const monthAgo = new Date(now);\n          monthAgo.setMonth(monthAgo.getMonth() - 1);\n          return saleDate >= monthAgo;\n        } else if (timeRange === 'year') {\n          const yearAgo = new Date(now);\n          yearAgo.setFullYear(yearAgo.getFullYear() - 1);\n          return saleDate >= yearAgo;\n        }\n        return true; // 'all'\n      });\n\n      // Calcular resumen de pagos\n      const summary = {\n        cash: 0,\n        debit: 0,\n        credit: 0,\n        transfer: 0,\n        mp: 0,\n        current_account: 0,\n        paid_current_account: 0\n      };\n\n      salesInTimeRange.forEach(sale => {\n        summary[sale.paymentMethod] += sale.total;\n      });\n\n      setPaymentSummary(summary);\n      setSales(salesInTimeRange);\n      setProducts(filteredProducts);\n      setCustomers(filteredCustomers);\n      setCashMovements(filteredCashMovements);\n    };\n    loadData();\n  }, [selectedMarket, timeRange]);\n\n  const getTopProducts = () => {\n    const productSales = {};\n    \n    sales.forEach(sale => {\n      sale.items.forEach(item => {\n        if (!productSales[item.productId]) {\n          productSales[item.productId] = {\n            quantity: 0,\n            revenue: 0,\n            name: item.name\n          };\n        }\n        productSales[item.productId].quantity += item.quantity;\n        productSales[item.productId].revenue += item.subtotal;\n      });\n    });\n\n    return Object.entries(productSales)\n      .map(([id, data]) => ({ id, ...data }))\n      .sort((a, b) => b.quantity - a.quantity)\n      .slice(0, 5);\n  };\n\n  const getLoyalCustomers = () => {\n    const customerSales = {};\n    sales.forEach(sale => {\n      if (sale.customerName && sale.customerName !== 'Consumidor Final') {\n        if (!customerSales[sale.customerName]) {\n          customerSales[sale.customerName] = {\n            totalSpent: 0,\n            visitCount: 0,\n            name: sale.customerName,\n            dni: sale.customerDNI\n          };\n        }\n        customerSales[sale.customerName].totalSpent += sale.total;\n        customerSales[sale.customerName].visitCount += 1;\n      }\n    });\n    return Object.values(customerSales).sort((a, b) => b.totalSpent - a.totalSpent).slice(0, 5);\n  };\n\n  const handleExportPDF = (reportType) => {\n    if (reportType === 'sales') {\n      generateSalesReport(sales, getTopProducts(), timeRange);\n    } else if (reportType === 'cashRegister') {\n      generateCashRegisterReport(cashMovements, timeRange);\n    } else if (reportType === 'currentAccounts') {\n      const currentAccountCustomers = {};\n      sales.forEach(sale => {\n        if (sale.paymentMethod === 'current_account' && sale.customerName) {\n          if (!currentAccountCustomers[sale.customerName]) {\n            currentAccountCustomers[sale.customerName] = {\n              name: sale.customerName,\n              dni: sale.customerDNI,\n              address: sale.customerAddress,\n              email: sale.customerEmail,\n              phone: sale.customerPhone,\n              totalDebt: 0,\n              sales: []\n            };\n          }\n          currentAccountCustomers[sale.customerName].totalDebt += sale.total;\n          currentAccountCustomers[sale.customerName].sales.push(sale);\n        }\n      });\n      generateCurrentAccountReport(Object.values(currentAccountCustomers), timeRange);\n    }\n  };\n\n  const getTimeRangeLabel = () => {\n    switch(timeRange) {\n      case 'day': return 'Diario';\n      case 'week': return 'Semanal';\n      case 'month': return 'Mensual';\n      case 'year': return 'Anual';\n      case 'all': return 'Histórico';\n      default: return '';\n    }\n  };\n\n  if (!isAdmin() && !isMarket()) {\n    return <div className=\"text-center py-10 text-gray-800 dark:text-white\">Acceso no autorizado</div>;\n  }\n\n  return (\n    <div className=\"bg-white p-6 rounded-lg shadow-md dark:bg-gray-800\">\n      <h2 className=\"text-2xl font-bold text-gray-800 dark:text-white mb-6\">Reportes y Estadísticas</h2>\n\n      <div className=\"flex justify-between items-center mb-6\">\n        <h3 className=\"text-lg font-medium text-gray-800 dark:text-white\">\n          Reporte {getTimeRangeLabel()} - {sales.length} ventas registradas\n        </h3>\n        <div className=\"flex space-x-2\">\n          <select\n            value={timeRange}\n            onChange={(e) => setTimeRange(e.target.value)}\n            className=\"px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\n          >\n            <option value=\"day\">Hoy</option>\n            <option value=\"week\">Última semana</option>\n            <option value=\"month\">Último mes</option>\n            <option value=\"year\">Último año</option>\n            <option value=\"all\">Todos</option>\n          </select>\n          <div className=\"relative group\">\n            <button\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              Exportar PDF\n            </button>\n            <div className=\"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 dark:bg-gray-700\">\n              <button onClick={() => handleExportPDF('sales')} className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left dark:text-gray-300 dark:hover:bg-gray-600\">Reporte de Ventas</button>\n              <button onClick={() => handleExportPDF('cashRegister')} className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left dark:text-gray-300 dark:hover:bg-gray-600\">Cierre de Caja</button>\n              <button onClick={() => handleExportPDF('currentAccounts')} className=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left dark:text-gray-300 dark:hover:bg-gray-600\">Cuentas Corrientes</button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <ProfitSummary sales={sales} products={products} />\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n        <div className=\"bg-white p-6 rounded-lg shadow-md dark:bg-gray-800\">\n          <h3 className=\"text-lg font-medium text-gray-800 dark:text-white mb-4\">Resumen de Pagos</h3>\n          <div className=\"space-y-3\">\n            <div className=\"flex justify-between text-gray-700 dark:text-gray-300\">\n              <span>Efectivo:</span>\n              <span className=\"font-medium\">${paymentSummary.cash.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between text-gray-700 dark:text-gray-300\">\n              <span>Tarjeta de Débito:</span>\n              <span className=\"font-medium\">${paymentSummary.debit.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between text-gray-700 dark:text-gray-300\">\n              <span>Tarjeta de Crédito:</span>\n              <span className=\"font-medium\">${paymentSummary.credit.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between text-gray-700 dark:text-gray-300\">\n              <span>Mercado Pago:</span>\n              <span className=\"font-medium\">${paymentSummary.mp.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between text-gray-700 dark:text-gray-300\">\n              <span>Cuenta Corriente:</span>\n              <span className=\"font-medium\">${paymentSummary.current_account.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between text-gray-700 dark:text-gray-300\">\n              <span>Cta. Cte. Pagada:</span>\n              <span className=\"font-medium\">${paymentSummary.paid_current_account.toFixed(2)}</span>\n            </div>\n            <div className=\"border-t border-gray-200 pt-2 flex justify-between font-bold dark:border-gray-600 dark:text-white\">\n              <span>Total:</span>\n              <span>${(paymentSummary.cash + paymentSummary.debit + paymentSummary.credit + paymentSummary.mp + paymentSummary.current_account + paymentSummary.paid_current_account).toFixed(2)}</span>\n            </div>\n          </div>\n        </div>\n        <DailySalesChart sales={sales} />\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <TopProductsChart topProducts={getTopProducts()} />\n        <div className=\"bg-white p-6 rounded-lg shadow-md dark:bg-gray-800\">\n          <h3 className=\"text-lg font-medium text-gray-800 dark:text-white mb-4\">Clientes Más Fieles</h3>\n          {getLoyalCustomers().length > 0 ? (\n            <ul className=\"space-y-2\">\n              {getLoyalCustomers().map((customer, index) => (\n                <li key={index} className=\"flex justify-between items-center text-sm text-gray-700 dark:text-gray-300\">\n                  <span>{customer.name} ({customer.visitCount} compras)</span>\n                  <span className=\"font-medium\">${customer.totalSpent.toFixed(2)}</span>\n                </li>\n              ))}\n            </ul>\n          ) : (\n            <p className=\"text-gray-500 dark:text-gray-300\">No hay datos de clientes fieles para mostrar.</p>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ReportsDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}